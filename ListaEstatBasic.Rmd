---
title: "Estatística: lista de exercício[^1]"
author: "Prof. Omar"
output: 
  bookdown::html_document2:
    css: style.css  
    #rmdformats::theme:
    #  flatly
    #theme: sandstone
#bibliography: bibliografiaETbook.bib
#biblio-style: authoryear
---


```{r setup , include=FALSE}
knitr::opts_chunk$set(echo = TRUE, 
                      size = "footnotesize",
                      comment = NA,
                      warning = FALSE,
                      message = FALSE,
                      #out.width = "1\\linewidth",
                      fig.align = "center",
                      fig.width = 8, 
                      fig.height = 4, 
                      fig.show = "hold",
                      fig.path = "Figuras1/",
                      fig.pos = "!htb",
                      fig.cap = TRUE,
                      background = "#E6E6FA",
                      #background = "black",
                      dev = c("png",'pdf'),
                      res=300,
                      dpi = 300,
                      cache = TRUE)
```

```{r library, echo=FALSE,results='hide'}
library(tidyverse)
library(tinytex)
library(knitr)
library(kableExtra)
library(xtable)
```

```{r functions, echo=FALSE, results='hide'}
# A function to scale input to 0-1
scale_01 <- function(x){
  (x - min(x, na.rm = TRUE)) / diff(range(x, na.rm = TRUE))
}
```

```{r read-data, echo=FALSE,results='hide'}
# gapminder <- read_csv(here::here("data", "gapminder.csv"))
```


[^1]: Este artigo é uma lista de exercícios sobre __estatística básica__. Provavelmente, esta lista ganhará novos exercícios ao longo do tempo. Os conjuntos de dados apresentados são meramente didáticos e não condizem com a realidade, em outras palavras, são fictícios. Se o conjunto de dados apresentado for real, isto será dito e a sua fonte também será mostrada. Caso encontre erros, queira fazer comentários, ou trocar uma ideia sobre o artigo, por favor, me escreva: omarcnpereiraead@gmail.com

# Estatística descritiva


1. Alguns funcionários de uma empresa decidiram participar de uma pesquisa para avaliar o tempo gasto para irem de casa ao trabalho usando o transporte coletivo e o automóvel próprio. Se você fosse o responsável por essa pesquisa, como a realizaria? De forma concisa descreva detalhes da coleta de dados e possíveis problemas que poderiam ocorrer.


2. Considere o problema anterior. Suponha que você tenha coletado uma amostra do tempo (minutos) de translado de casa ao trabalho de 10 funcionários, ora indo de transporte coletivo, ora de carro próprio (Tabela \@ref(tab:transp)). Esse tipo de dados tem estrutura pareada (em breve estudaremos isto com detalhes).

```{r transp, echo=FALSE, fig.pos="!H",out.extra = "", results='asis'}
set.seed(7)
pp <- round(rnorm(10,mean=30,sd=5),0)
qq <- round(rnorm(10,mean=20,sd=5),0)
dd <- t(data.frame(Funcionario=1:10,
                 TC=pp, AP=qq))
dt <- as.data.frame(t(dd))
dd %>% 
  kable(caption = "Tempo gasto, em minutos, para 10 funcionários irem de casa até a empresa em que trabalham de duas maneiras, ou transporte coletivo (TC) ou automóvel próprio (AP).") %>% 
  kable_styling(full_width = FALSE, latex_options = "HOLD_position")
```

```{r}
TC <- c(41,24,27,28,25,25,34,29,31,41)
AP <- c(22,34,31,22,29,22,16,18,20,25)
dados <- data.frame(Funcionario=1:10,TC,AP)
dados
```

* Calcule o tempo médio e o desvio padrão de cada tipo de locomoção.

```{r}
# Média e desvio padrão de TC
mean(dados[,2])
sd(dados[,2])
# Média e desvio padrão de AP
mean(dados[,3])
sd(dados[,3])
```


* Em função dos resultados acima, qual meio de transporte deve ser preferido? Discuta.
* Compare a dispersão dos dois meios de transporte. Qual tem maior dispersão?

```{r}
#Coeficiente de Variação (%):
#TC
round((sd(dados[,2])/mean(dados[,2]))*100,2)
#AP
round((sd(dados[,3])/mean(dados[,3]))*100,2)
```


3. Uma pesquisa mostrou que o brasileiro gasta em média R\$234,19 por mês se alimentando fora de casa (dados fictícios). Os gastos mensais para se alimentar fora de casa referentes a uma amostra de 30 adolescentes estão apresentados na Tabela \@ref(tab:adoles). 

```{r adoles, echo=FALSE, fig.pos="!H",out.extra = "", results='asis'}
set.seed(7)
dp <- round(rnorm(30,325,100),0)
dp <- rpois(30,325)
dp %>% matrix(nrow = 3) %>% 
  kable(caption = "Gastos mensais de 30 adolescentes para se alimentarem fora de casa.") %>% 
  kable_styling(full_width = FALSE, latex_options = "HOLD_position")
```

```{r}
# Dados
dados <- c(309,324,305,312,281,341,355,296,
           342,337,334,321,322,299,335,320,
           338,330,323,330,332,342,346,317,
           326,319,333,339,311,344)
dados
```

* Faça uma tabela de distribuição de frequências (use o bom senso).
* Esboce um histograma.

```{r histograns, fig.cap="Histogramas (frequência e densidade) dos gastos mensais de 30 adolescentes para se alimentarem."}
# histograma de frequência absoluta
hist(dados, labels = T, main = "",
     xlab = 'Gasto (R$)', ylab = 'Frequência',
     ylim =c(0,9))
#
# histograma com densidade
hist(dados, labels = T, main = "",
     xlab = 'Gasto (R$)', ylab = 'Densidade',
     probability = T, ylim = c(0,0.025))
```

* Qual a proporção de elementos entre os valores 315 e 345?
* Calcule a média, a mediana e a moda.

```{r}
summary(dados)
```


* Se considerarmos os dados do item anterior, esses adolescentes gastam o mesmo que a média dos brasileiros que se alimentam fora?
* Calcule o primeiro e o terceiro quartis.
* Calcule a amplitude e a amplitude interquartil.
* Construa um boxplot.

```{r box1, fig.cap="Boxplot dos gastos mensais de 30 adolescentes para se alimentarem."}
boxplot(dados, ylab = "Gastos (R$)")
```


* Calcule a variância, o desvio-padrão e o coeficiente de variação.

```{r}
var(dados)
sd(dados)
(sd(dados)/mean(dados))*100
```


4. As receitas de duas concessionárias estão apresentadas na Tabela \@ref(tab:conces). Qual delas apresenta maior dispersão? Discuta os resultados.

| Concessionária | Média (R\$) | Desvio (R\$) |
|:--------------:|:---------:|:----------:|
|        A       |  3280000  |   1500000  |
|        B       |   630000  |   500000   |

Table: (\#tab:conces) Receita das concecionárias A e B. 

```{r}
# Coeficiente de variação
# A:
(1500000/3280000)*100
#B
(500000/630000)*100
```

## Análise bivariada

5. Na Tabela \@ref(tab:corr1) é apresentado seis observações das variáveis $X$ e $Y$.

```{r corr1, echo=FALSE, fig.pos="!H",out.extra = "", results='asis'}
set.seed(1)
x <- round(rnorm(6,mean = 10,sd=4),0)
y <- x + round(rnorm(6,mean = 0,sd=1),0)
dd <- t(data.frame(X=x, Y=y))
dd %>% 
  kable(caption = "Seis observações das variáveis X e Y.") %>% 
  kable_styling(full_width = FALSE, latex_options = "HOLD_position")
```

```{r}
x <- c(7,11,7,16,11,7)
y <- c(7,12,8,16,13,7)
dados3 <- data.frame(X=x, Y=y)
dados3
```

* Faça um diagrama de dispersão ($X$ no eixo horizontal).

```{r}
plot(Y~X, dados3)
```

* Calcule a covariância da amostra.

```{r}
cov(x,y)
```

* Calcule e interprete a correlação da amostra.

```{r}
cor(x,y)
# ou 
cov(x,y)/(sd(x)*sd(y))
```


6. O diretor de uma escola quer saber se há associação entre a média escolar ($ME$) e o desempenho em um simulado ($SIM$). Na Tabela \@ref(tab:corr2) é apresentado uma amostra de seis alunos.

```{r corr2, echo=FALSE, fig.pos="!H",out.extra = "", results='asis'}
set.seed(1)
Aluno <- round(1:6,0)
x <- round(rnorm(6,mean = 6,sd=1.1),1)
y <- x + round(rnorm(6,mean = 0,sd=0.5),1)
dd <- t(data.frame(Aluno, ME=x, SIM=y))
dd %>% 
  kable(caption = "Seis observações das variáveis ME e SIM.") %>% 
  kable_styling(full_width = FALSE, latex_options = "HOLD_position")
```

```{r}
ME     <- c(5.3,6.2,5.1,7.8,6.4,5.1)
SIM	   <- c(5.5,6.6,5.4,7.6,7.2,5.3)
dados4 <- data.frame(Aluno=1:6,ME, SIM)
dados4
```


* Faça um diagrama de dispersão ($ME$ no eixo horizontal).

```{r}
plot(ME~SIM,data = dados4)
```

* Calcule a covariância da amostra.

```{r}
cov(dados4$ME,dados4$SIM)
```

* Calcule e interprete a correlação da amostra.

```{r}
cor(dados4$ME,dados4$SIM)
# ou 
cov(dados4$ME,dados4$SIM)/(sd(dados4$ME)*sd(dados4$SIM))
```

7. __Tempo de caminhada $\times$ Gordura corporal.__ Dados de tempo semanal de caminhada (horas) e a gordura corporal (\%) de oito indivíduos do sexo masculino com idade acima de 60 anos são apresentados na Tabela \@ref(tab:corr3).

```{r corr3, echo=FALSE, fig.pos="!H",out.extra = "", results='asis'}
set.seed(1)
x <- c(6,12,4,2,5,7,14,10)
y <- c(22,11,23,25,21,19,9,12)
dd <- t(data.frame(Indivíduo=1:8, Tempo=x, Gordura =y))
dd %>% 
  kable(caption = "Tempo de caminhada (horas) e gordura corporal (%) de oito indivíduos.") %>% 
  kable_styling(full_width = FALSE, latex_options = "HOLD_position")
```

* Faça um diagrama de dispersão (coloque o tempo no eixo horizontal).

* Calcule a covariância da amostra.

* Calcule e interprete a correlação da amostra.

# Noções de Probabilidades

1. Determine a probabilidade de aparecer um quatro pelo menos uma vez em dois lançamentos de um dado honesto.

2. Suponha duas extrações em uma urna onde há 3 bolas verdes e 4 bolas amarelas. Construa um diagrama em árvore e escreva as probabilidades para os casos:

* Sem reposição

* Com reposição

3. Os fornecedores $A_1$, $A_2$ e $A_3$ são responsáveis 40\%, 35\% e 25\% dos componentes eletrônicos vendidos por uma loja. Sabe-se que os componentes fabricados por esses fornecedores tem uma taxa de defeitos de 2\%, 3\% e 4\%.

* Qual a probabilidade da loja vender um componente eletrônico com defeito?

* Qual a probabilidade de um componente eletrônico defeituoso que foi vendido pela loja ser do fornecedor $A_1$? 

4. Os centros cirúrgicos $A_1$, $A_2$ e $A_3$ são responsáveis por 38\%, 34\% e 28\% das cirurgias em um Hospital. Esses centros cirúrgicos apresentam 0.5\%, 0.7\% e 1.2\% de infecção hospitalar.

* Qual a probabilidade de um paciente internado nesse Hospital ter infecção hospitalar?

* Qual a probabilidade de um paciente com infecção hospitalar ter realizado cirurgia no centro $A_1$?

5. Suponha que você está criando um teste diagnóstico para uma dada doença. Então, seleciona 500 indivíduos, 250 doentes e 250 não doentes pelo padrão-ouro e aplica o teste. Os resultados podem ser vistos na Tabela \@ref(tab:teste1).

|   Teste  | Doentes | Não doentes |
|:--------:|:-------:|:-----------:|
| Positivo |   241   |      25     |
| Negativo |    9    |     225     |
|   Total  |   250   |     250     |
|          |         |             |

Table: (\#tab:teste1) Padrão-ouro para a sensibilidade e especificidade do teste diagnóstico.

* Qual a sensibilidade do teste?
* Qual a especificidade do teste?
* Supondo que essa doença atinge 0.5\% da população, qual o Valor Preditivo Positivo (VPP) e o Valor Preditivo Negativo (VPN)?
* Agora suponha que 15\% da população tem essa doença, qual o Valor Preditivo Positivo (VPP) e o Valor Preditivo Negativo (VPN)?

6. Suponha que você irá fazer um teste com quatro questões. Em cada questão há cinco alternativas, das quais apenas uma está correta. Qual a probabilidade de acertar as quatro questões no "chute"?

7. A probabilidade de um atirador acertar um alvo é de 40\%. Suponha que o atirador disparou quinze vezes. Qual a probabilidade de:

* Acertar exatamente cinco vezes o alvo?
* Acertar o alvo pelo menos três vezes (pelo menos três vezes quer dizer três, quatro, cinco, $\cdots$ ou 15 vezes). Sugestão: $P(X \geq 3)$ = $1 - P(X<3)$ = $1 - \{P(X=0) + P(X=1) + P(X=2) \}$ 



